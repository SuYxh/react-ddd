

## 🔍 一、DDD 是什么？

DDD 由 **Eric Evans** 在 2003 年出版的《Domain-Driven Design: Tackling Complexity in the Heart of Software》一书中提出，强调：

> 以业务领域为中心，通过与领域专家的持续协作，构建反映真实业务语义的模型，从而指导软件系统设计与演化。

------

## 🧱 二、DDD 架构核心组成

DDD 可以从**战略设计**和**战术设计**两个层面理解：

### 1. **战略设计（Strategic Design）**

重点在**如何划分系统结构和组织团队**，主要包括：

#### 🟧（1）Bounded Context（限界上下文）

- 指的是**业务模型的适用范围边界**。
- 不同的上下文中同一个概念可能含义不同，例如“订单”在销售系统与库存系统可能含义不同。
- 每个 Bounded Context 负责自己的一套业务逻辑和模型。

#### 🟧（2）Context Map（上下文地图）

- 描绘各个 Bounded Context 之间的关系，例如：
  - **客户-供应商**（Customer-Supplier）
  - **防腐层**（Anti-Corruption Layer，ACL）
  - **共享内核**（Shared Kernel）

#### 🟧（3）Subdomain（子域）

- 把整个业务领域划分成多个子域：
  - **核心子域（Core Domain）**：系统的核心价值
  - **支撑子域（Supporting Subdomain）**：为核心子域提供支撑
  - **通用子域（Generic Subdomain）**：如认证、通知、日志等通用功能

------

### 2. **战术设计（Tactical Design）**

关注具体代码实现层面，主要概念包括：

#### 🟩（1）Entity（实体）

- 有唯一标识（ID），生命周期长，通常与数据库表对应。
- 例如：订单（Order）、用户（User）

#### 🟩（2）Value Object（值对象）

- 无唯一标识，用于描述某种属性组合。
- 例如：地址（Address）、货币（Money）

#### 🟩（3）Aggregate（聚合）

- 一组相关实体和值对象的集合，具有一个根实体（Aggregate Root），外界只能通过它来访问内部数据。
- 聚合的事务边界 = 聚合根的生命周期。

#### 🟩（4）Repository（仓储）

- 提供聚合的持久化和重建能力，例如 findById、save。
- 隐藏数据访问细节（如 ORM / SQL）。

#### 🟩（5）Domain Service（领域服务）

- 代表**不适合放在某个实体或值对象中的行为**，但又是领域相关的逻辑。
- 例如：货币兑换服务、风险评估服务。

#### 🟩（6）Application Service（应用服务）

- 处理用例级别的协调逻辑，调度领域对象完成任务，通常不包含业务规则。
- 类似一个“中介”。

#### 🟩（7）Domain Event（领域事件）

- 描述领域中发生的某个有业务意义的事件。
- 例如：用户已注册（UserRegistered）、订单已支付（OrderPaid）

------

## 🧭 三、典型 DDD 架构分层图

```
+-----------------------------+
|         Interface           | ← 接口层 / 表现层（Web、API）
+-----------------------------+
|     Application Service     | ← 应用服务层（调度协调逻辑）
+-----------------------------+
|      Domain (核心层)        | ← 实体、值对象、领域服务、聚合根、领域事件
+-----------------------------+
|        Infrastructure       | ← 基础设施层（ORM、数据库、消息队列、外部服务适配）
+-----------------------------+
```

------

## 🧪 四、DDD 实践建议

| 实践建议                | 说明                                                     |
| ----------------------- | -------------------------------------------------------- |
| 与领域专家深入沟通      | 模型从业务中来，持续 Ubiquitous Language（通用语言）对齐 |
| 聚焦核心子域            | 重点建设系统的核心价值                                   |
| 小步建模                | 持续建模 + 演进，逐步推进行为和模型分离                  |
| 建立合理的上下文边界    | 利于团队协作与代码解耦                                   |
| 使用测试驱动设计（TDD） | 确保领域模型行为正确性                                   |

------

## 🛠 五、技术选型与 DDD

- ORM：TypeORM、Hibernate、JPA 等（用于实现 Repository）
- 框架支持：Spring Boot（Java）、NestJS（Node.js）、ASP.NET（C#）等
- 架构风格：适合微服务（每个服务 = 一个 Bounded Context）

------

## 📚 六、适合应用 DDD 的场景

✅ 适合：

- 企业级复杂业务系统（如电商、金融、SaaS）
- 需要清晰业务模型与持续演化
- 多团队协作开发系统

❌ 不适合：

- 简单 CRUD 系统（如后台管理面板）
- 初创项目或 MVP 快速验证阶段

------

如果你需要具体的 DDD 实践案例（如：订单系统、用户中心、商品库存系统的领域建模），我可以继续为你展开。需要吗？